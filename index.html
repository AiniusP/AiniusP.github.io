<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Find a Nostalgic Hit For Your Month</title>
<link rel="stylesheet" href="styles.css">
</head>
<body class="dark-mode">
  <div class="container">
    <h1>Find Nostalgic Hits</h1>
    <div class="select-container">
      <div class="select-wrapper">
        <label for="year">Select Year:</label>
        <select id="year" class="select-large">
          <!-- Populate with years from 1995 to 2015 -->
          <!-- Options will be added dynamically using JavaScript -->
        </select>
      </div>
      <div class="select-wrapper">
        <label for="month">Select Month:</label>
        <select id="month" class="select-large">
          <!-- Populate with months -->
          <option value="1">January</option>
          <option value="2">February</option>
          <option value="3">March</option>
          <option value="4">April</option>
          <option value="5">May</option>
          <option value="6">June</option>
          <option value="7">July</option>
          <option value="8">August</option>
          <option value="9">September</option>
          <option value="10">October</option>
          <option value="11">November</option>
          <option value="12">December</option>
        </select>
      </div>
      <button onclick="showTopReleases()" class="btn-large">Find!</button>
    </div>
    <div id="topReleases" class="top-releases">
      <ul id="releaseList"></ul>
    </div>
  </div>
  <div class="dancing-monkey">
    <img src="dancing-monkey.gif" alt="Dancing Monkey">
  </div>
  <script>
    // Function to fetch top releases data from Spotify API for a specific year and month
    async function fetchTopReleases(year, month) {
      const clientId = "67f1dfb000944599beb31f1d56922d23";
      const clientSecret = "ad79e1c6cb664a53ad3f8fb6e9c17a7d";
      const tokenUrl = 'https://accounts.spotify.com/api/token';
      const playlists = {
        '2015/01': '2KtGns2GFUd9NSK3jXljWl',
        '2015/02': '60qlSnqSVNfoLRQEDfO5of',
        '2015/03': '06bI3ZOMHRFDT4wUf9Q69T',
        '2015/04': '0Dqad8NfbkYNfaWF161NNM',
        '2015/05': '1FBmHfxq7y7X1PiA6j3L5z',
        '2015/06': '5sNIdIvfUQDq75zzAUXkx0',
        '2015/07': '3fxzT8LFleqwy4Zw5eh9jI',
        '2015/08': '6FIsj9Qk3p35qITl53E2r9',
        '2015/09': '2w7ZQ7tiWMjJUO6IliMcjZ',
        '2015/10': '3SicnDKoXzDMZ8HJUVFuQt',
        '2015/11': '1SRIoXyzqMKmxaAO4GmNIV',
        '2015/12': '3Iev42KrJ2xkzptreh4Jvf',
        '2014/01': '3gaLb5PddshyrIotaBr3uB',
        '2014/02': '36hZyuN7cmSXbJOhg4pK93',
        '2014/03': '60P7yIZaJElz7SIN6MYsMa',
        '2014/04': '4h9d3m6H3pmTk8L3TaeOn0',
        '2014/05': '5d6mmzf0LvmIfA1IXXpjh7',
        '2014/06': '4oT7DO0gchmK75lvsyksis',
        '2014/07': '5wIT7Xfur4BpnoTZIw6IeX',
        '2014/08': '4imn2jYIPtjkCEvFwgtsbO',
        '2014/09': '69V6sH7CNyJ6kjXLQfwRUF',
        '2014/10': '3PuV7XsESK31cyZkS39eCC',
        '2014/11': '2V3uyyGqqARl9p7PQmZTud',
        '2014/12': '0irN7NndJTlwVWcrUZKmlC',
        '2013/01': '7AqC7hcmGBGZLpKo3RO1A1',
        '2013/02': '0NFs4NQ5nCzqvTzQvz3FvE',
        '2013/03': '4CaYhMQ3IIQY2manxWcRvj',
        '2013/04': '2LRD9u8zKmT5gtMPD6CJqp',
        '2013/05': '0ickzWtzcekFkEiPlvisvc',
        '2013/06': '0OlPufIBjYepS5pWDAyqCH',
        '2013/07': '2RtrP9bfqIxKG14R9yinIJ',
        '2013/08': '0UMwW3sIsHgOBgufTgwVIj',
        '2013/09': '6SnH9glUeWPBh70Bn2ultV',
        '2013/10': '5bypPBbPILTdFbqfbAStVP',
        '2013/11': '0FfH0cdHBfINPxKI6Ppnkh',
        '2013/12': '5X9tQcsiPqHeZnCrIpn5sE',
        '2012/01': '5w6e8NrjwUYZf4k418GhZM',
        '2012/02': '66U9wMrfcossvNQ3CAaBTp',
        '2012/03': '7MPQTi2yT1YY1OwLS0h9gH',
        '2012/04': '1f7Pb4f8OPEJkVNXjHu52U',
        '2012/05': '56LqnRWEhZfQixbhAT0Wo3',
        '2012/06': '4OfajDOm2L7ElloSoqa46o',
        '2012/07': '3dWH4X3TbIssGWKIRuiAMH',
        '2012/08': '5I3Y98fBgAILA5Ib26vfJ9',
        '2012/09': '6IseQf6MkBdduoGO87RlgV',
        '2012/10': '0pA2HZnMRGmBSn5f20o5aI',
        '2012/11': '5HSy8shP9na08BQxKjbaAV',
        '2012/12': '1mgfMnOel8C2S0t6Bq6Tt2',
        '2011/01': '', // You can add the playlists for 2011 if you have them
        // Add playlists for other years if available
      };

      const playlistId = playlists[`${year}/${month.toString().padStart(2, '0')}`];
      if (!playlistId) {
        console.error(`No playlist found for ${year}/${month.toString().padStart(2, '0')}`);
        return [];
      }
      const apiUrl = `https://api.spotify.com/v1/playlists/${playlistId}/tracks?market=US&fields=items(track(name,id))&limit=3&offset=0`;

      try {
        // Fetch access token
        const tokenResponse = await fetch(tokenUrl, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
            'Authorization': 'Basic ' + btoa(clientId + ':' + clientSecret),
          },
          body: 'grant_type=client_credentials',
        });

        const tokenData = await tokenResponse.json();
        const accessToken = tokenData.access_token;

        // Fetch top tracks
        const response = await fetch(apiUrl, {
          headers: {
            'Authorization': 'Bearer ' + accessToken,
          },
        });

        const data = await response.json();
        return data.items.map(item => ({ name: item.track.name, id: item.track.id }));
      } catch (error) {
        console.error('Error fetching top releases:', error);
        return [];
      }
    }

    // Function to fetch top releases data for the selected year and month
    async function showTopReleases() {
      const selectedYear = document.getElementById("year").value;
      const selectedMonth = document.getElementById("month").value;
      const topReleases = await fetchTopReleases(selectedYear, selectedMonth) || [];

      const releaseList = document.getElementById("releaseList");
      releaseList.innerHTML = ""; // Clear previous releases
      
      if (topReleases.length > 0) {
        topReleases.forEach(release => {
          const listItem = document.createElement("li");
          const trackName = release.name;
          const trackId = release.id;
          listItem.textContent = trackName;
          const playButton = document.createElement("button");
          playButton.textContent = "Play";
          playButton.onclick = function() {
            window.open(`https://open.spotify.com/track/${trackId}`, '_blank');
          };
          listItem.appendChild(playButton);
          releaseList.appendChild(listItem);
        });
      } else {
        const listItem = document.createElement("li");
        listItem.textContent = "No top releases found for the selected year and month.";
        releaseList.appendChild(listItem);
      }
    }

    // Function to populate year dropdown with options
    function populateYearDropdown() {
      const yearDropdown = document.getElementById("year");
      for (let year = 1995; year <= 2015; year++) {
        const option = document.createElement("option");
        option.value = year;
        option.textContent = year;
        yearDropdown.appendChild(option);
      }
    }

    // Populate year dropdown on page load
    populateYearDropdown();
  </script>
</body>
</html>
